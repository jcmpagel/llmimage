<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4285f4">
    <title>Wikimedia Image-Enhanced Q&A Tool</title>
    <script defer src="https://umami-nu-steel.vercel.app/script.js" data-website-id="02a020e7-317c-425f-898a-8f54f1f81374"></script>
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* Base Styling */
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        /* Header and Navigation */
        header {
            margin-bottom: 30px;
        }
        
        .social-links {
            margin: 20px 0;
            text-align: center;
        }
        .toggle-switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  transform: translateX(26px);
}

.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}

.required-field label:after {
  content: "*";
  color: red;
  margin-left: 3px;
}
        
        .social-icons {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .social-icons li a {
            color: #4285f4;
            text-decoration: none;
            font-weight: bold;
        }
        
        .social-icons li a:hover {
            text-decoration: underline;
        }
        
        .internship-note {
            color: #666;
            padding: 8px 0;
            text-align: right;
            margin-bottom: 15px;
            font-size: 0.9em;
            font-style: italic;
        }
        
        /* User Guide */
        .user-guide {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #4285f4;
        }
        
        .user-guide ul {
            margin: 10px 0 0 20px;
        }
        
        .example-link {
            color: #4285f4;
            text-decoration: none;
            font-weight: bold;
        }
        
        .example-link:hover {
            text-decoration: underline;
        }
        
        /* Form Elements */
        .form-container {
            margin-bottom: 30px;
        }
        
        #user-question {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        #submit-btn {
            padding: 10px 15px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        
        #submit-btn:hover {
            background-color: #3367d6;
        }
        
        .api-key-input {
            margin-top: 10px;
        }
        
        .api-key-help {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        .form-group {
            margin-top: 15px;
        }
        
        select.form-control {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        /* Loading Indicator */
        #loading {
            display: none;
            margin: 20px 0;
            font-weight: bold;
            color: #4285f4;
        }
        
        /* Response Area */
        #response-container {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 5px;
            background-color: #fafafa;
        }
        
        /* How It Works Section */
        .how-it-works {
            margin: 30px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            background-color: #f9f9f9;
        }
        
        .how-it-works h3 {
            margin-top: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toggle-btn {
            background-color: #4285f4;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .toggle-btn:hover {
            background-color: #3367d6;
        }
        
        /* Debug Sections */
        .debug-section {
            margin-top: 30px;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }
        
        .debug-log {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        /* Image Preview */
        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .image-item {
            max-width: 200px;
            margin-bottom: 10px;
        }
        
        .image-item img {
            max-width: 100%;
            height: auto;
            border-radius: 3px;
        }
        
        .image-item p {
            margin-top: 5px;
            font-size: 0.8em;
            color: #666;
        }
        
        /* Markdown Content Styling */
        #response-container h1, #response-container h2, #response-container h3,
        #response-container h4, #response-container h5, #response-container h6 {
            margin-top: 1em;
            margin-bottom: 0.5em;
        }
        
        #response-container p {
            margin-bottom: 1em;
            line-height: 1.6;
        }
        
        #response-container ul, #response-container ol {
            margin-left: 2em;
            margin-bottom: 1em;
        }
        
        #response-container code {
            background-color: #f4f4f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        #response-container pre {
            background-color: #f4f4f4;
            padding: 1em;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 1em;
        }
        
        #response-container blockquote {
            border-left: 4px solid #ddd;
            padding-left: 1em;
            color: #666;
            margin-left: 0;
            margin-bottom: 1em;
        }
        
        #response-container table {
            border-collapse: collapse;
            margin-bottom: 1em;
            width: 100%;
        }
        
        #response-container table, #response-container th, #response-container td {
            border: 1px solid #ddd;
        }
        
        #response-container th, #response-container td {
            padding: 8px;
            text-align: left;
        }
        
        #response-container th {
            background-color: #f4f4f4;
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            #submit-btn {
                width: 100%;
                margin-top: 10px;
            }
            
            .image-item {
                max-width: 100%;
            }
            
            #response-container img {
                max-width: 100%;
                height: auto;
            }
            .social-icons {
        flex-wrap: wrap;
    }
    
    #api-key {
        width: 100%;
        margin-top: 5px;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 5px;
    }
    
    .form-group select {
        width: 100%;
    }
    
    /* Make the debug sections more compact on mobile */
    .debug-section {
        margin-top: 20px;
        padding-top: 15px;
    }
    
    .debug-log {
        max-height: 200px;
    }
}
    </style>
</head>
<body>
    <!-- GitHub Corner -->
<a href="https://github.com/jcmpagel/llmimage" class="github-corner" aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#4285f4; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
      <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
      <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
  </a>
  <style>
    .github-corner:hover .octo-arm {
      animation: octocat-wave 560ms ease-in-out
    }
    @keyframes octocat-wave {
      0%, 100% {transform: rotate(0)}
      20%, 60% {transform: rotate(-25deg)}
      40%, 80% {transform: rotate(10deg)}
    }
    @media (max-width: 500px) {
      .github-corner:hover .octo-arm {
        animation: none
      }
      .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }
    }
    #submit-btn[disabled] {
    background-color: #cccccc;
    cursor: not-allowed;
}

.loading-state {
    display: inline-block;
    margin-left: 8px;
}

.btn-processing {
    background-color: #fbbc05 !important; /* Yellow */
}

.btn-finding {
    background-color: #34a853 !important; /* Green */
}

.btn-analyzing {
    background-color: #ea4335 !important; /* Red */
}
  </style>
    <header>
        <h1>Wikimedia Image-Enhanced Q&A Tool</h1>
        <div class="social-links">
            <ul class="social-icons">
                <li><a href="https://www.instagram.com/jonathanpagel/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">Instagram</a></li>
                <li><a href="https://www.linkedin.com/in/jonathan-pagel-a3568a163/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">LinkedIn</a></li>
                <li><a href="mailto:jcmpagel@gmail.com" aria-label="Email">Email</a></li>
                <li><a href="https://github.com/jcmpagel" target="_blank" rel="noopener noreferrer" aria-label="GitHub">GitHub</a></li>
            </ul>
            <p class="internship-note" style="text-align: center;">Open for internships btw :)</p>
        </div>
    </header>

    <main>
        <section class="user-guide">
            <p>Ask any question and get an answer with relevant images from Wikimedia Commons. Or check out these examples:</p>
            <ul>
                <li><a href="view.html?id=8now7ndd5s8ugouxpdjed" class="example-link" target="_blank">Show me different types of cloud formations</a></li>
                <li><a href="view.html?id=5flvvmhia854nt8o4nut4q" class="example-link" target="_blank">Explain the perceptron in machine learning</a></li>
                <li><a href="view.html?id=4p7rksvae5f7xkoocjqzgl" class="example-link" target="_blank">Explain the human heart</a></li>
            </ul>
        </section>
        
        <section class="form-container">
            <form id="question-form" onsubmit="return false;">
                <textarea id="user-question" rows="3" placeholder="Type your question here and click 'Ask Question'..." autofocus></textarea>
                <button id="submit-btn" type="submit" class="submit-btn-primary">Ask Question</button>
                <div class="api-key-input">
                    <label for="api-key">Add your Gemini API key: </label>
                    <input type="password" id="api-key" placeholder="Gemini API Key">
                    <div class="api-key-help">
                        <p>Need an API key? <a href="https://aistudio.google.com/apikey" target="_blank">Get one from Google AI Studio</a>. If you encounter usage limits, you can create your own key for free.</p>
                    </div>
                </div>
            </form>
            
            <div class="form-group">
                <label for="use-proxy-toggle">Use My API Key, maybe out of limit</label>
                <div class="toggle-switch">
                  <input type="checkbox" id="use-proxy-toggle" checked>
                  <span class="slider round"></span>
                </div>
                <small>When enabled, you can use the app without your own API key (subject to rate limits)</small>
              </div>
        </section>
        <div class="form-group">
            <label for="model-selector">Select Gemini Model:</label>
            <select id="model-selector" class="form-control">
              <option value="gemini-2.0-flash">Gemini 2.0 Flash (Standard)</option>
              <option value="gemini-2.0-flash-thinking">Gemini 2.0 Flash-Thinking (Better reasoning)</option>
            </select>
            <small>Flash-Thinking provides more thoughtful responses but may be slower</small>
          </div>

        <div id="loading">Processing your question...</div>
        
        <section id="response-container"></section>


        <section class="how-it-works">
            <h3>How it Works <button id="toggle-info" class="toggle-btn">Show</button></h3>
            <div id="info-container" style="display: none;">
                <ol>
                    <li><strong>Search Term Generation:</strong> When you submit a question, the app uses Gemini AI to generate relevant search terms.</li>
                    <li><strong>Image Retrieval:</strong> These search terms are used to find relevant images from Wikimedia Commons.</li>
                    <li><strong>Image Analysis:</strong> Gemini AI analyzes the images alongside your question to create a visual response.</li>
                    <li><strong>Response Generation:</strong> The AI creates an answer that incorporates relevant images with explanatory text.</li>
                </ol>
                <p><strong>Privacy Note:</strong> Your API key is used only for API calls and is not stored beyond your current session.</p>
            </div>
        </section>
    </main>
    
    <footer>
        <div class="debug-section">
            <h3>Debug Log</h3>
            <div id="debug-log" class="debug-log"></div>
        </div>
        
        <div class="debug-section">
            <h3>Retrieved Images</h3>
            <div id="image-preview" class="image-preview"></div>
        </div>
    </footer>

    <script src="prompts.js"></script>
    <script src="app.js"></script>
</body>
</html>